<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" th:href="@{/css/base.css}">
  <link rel="stylesheet" th:href="@{/css/style.css}">
  <link rel="stylesheet" th:href="@{./css/bxh.css}">
  <link rel="stylesheet" th:href="@{/css/profile.css}">
  <link rel="stylesheet" th:href="@{/css/edit_info.css}">
  <div th:replace="~{fragments::html_head}"></div>
  <title>Đổi mật khẩu</title>
</head>

<body style="    background-color: #f2f2f5;">
<script th:inline="javascript">
  /* Set message variable with Thymeleaf */
  var message = [[${message}]];
  if(message!==null){
    showMessage(message)
    // console.log(message)
  }
</script>

<div class="profile">
  <header th:replace="~{fragments::navbar}"></header>
  <div class="container">

    <div class="profile_container">
      <div class="row">
        <div class="profile_post col-8">
          <div class="info_box">
            <div class="task_header">
              <span style="padding-left: 16px;">ĐỔI MẬT KHẨU</span>
            </div>
            <form th:action="@{/change-password}" method="post" id = "form-info"  >
              <div class="task_info">
                <div class="task_info_group">
                  <div class="task_info_item">
                    <label class="task_info_item-head">Mật khẩu hiện tại</label>
                    <input id="oldPass" name = "oldPass" type="password"
                           class="task_info_item-input">
                    <span class="task_info-input_message"></span>
                  </div>
                </div>

                <div class="task_info_group">
                  <div class="task_info_item">
                    <label class="task_info_item-head">Mật khẩu mới</label>
                    <input id="newPass" name = "newPass" type="password"
                           class="task_info_item-input">
                    <span class="task_info-input_message"></span>
                  </div>
                </div>

                <div class="task_info_group">
                  <div class="task_info_item">
                    <label class="task_info_item-head">Nhập lại mật khẩu</label>
                    <input id="reType" name = "reType" type="password"
                           class="task_info_item-input">
                    <span class="task_info-input_message"></span>
                  </div>
                </div>
              </div>
              <button style="background-color: #ff2a2a;
                                border: none;
                                border-radius: 4px;
                                padding: 6px 42px;
                                color: #fff;">Đổi mật khẩu</button>
            </form>
          </div>
        </div>
        <div class="profile_about col-4">
          <div class="info_box">
            <ul class="profile_detail">
              <li class="profile_detail-item">
                <span class="detail_name">User ID</span>
                <span class="detail_data" th:text = "${user.idUser}"></span>
              </li>
              <li class="profile_detail-item">
                <span class="detail_name">Username</span>
                <span class="detail_data" th:text = "${user.account.username}"></span>
              </li>
              <li class="profile_detail-item">
                <span class="detail_name">Email</span>
                <span class="detail_data" th:text = "${user.email}"></span>
              </li>
              <li class="profile_detail-item">
                <span class="detail_name">Chức danh</span>
                <span class="detail_data" th:text = "${user.account.role.roleName}"></span>
              </li>
              <li class="profile_detail-item">
                <span class="detail_name">FPoint</span>
                <span class="detail_data" th:text = "${user.totalPoint()}"></span>
              </li>
            </ul>
          </div>
        </div>

      </div>
    </div>


  </div>
</div>
<script type="text/javascript" th:src="@{/js/user_navbar.js}"></script>
<script type="text/javascript" th:src="@{/js/validator.js}"></script>
<script th:inline="javascript">
  Validator({
    form: "#form-info",
    formGroupSelector: '.task_info_group',
    errorSelector: '.task_info-input_message',
    rules:[
      Validator.isRequired("#oldPass"),
      Validator.isRequired("#newPass"),
      Validator.isRequired("#reType"),
      Validator.minLength("#oldPass",6),
      Validator.minLength("#newPass",6),
      Validator.minLength("#reType",6),
      Validator.isConfirmed("#reType",function(){
        return document.querySelector('#form-info #newPass').value
      },'Mật khẩu nhập lại không chính xác.'),
    ]
  });
</script>
</body>
</html>